import java.util.ArrayList;

/**
 * Bus.java
 * Menangani koleksi penumpang dan aturan naik/turun
 */
public class Bus {
    private ArrayList<Penumpang> penumpangBiasa = new ArrayList<>();
    private ArrayList<Penumpang> penumpangPrioritas = new ArrayList<>();
    private ArrayList<Penumpang> penumpangBerdiri = new ArrayList<>();

    public static final int ONGKOS_BUS = 2000;
    private int totalPendapatan = 0;

    // cek apakah ID sudah ada di bus
    public boolean idExists(int id) {
        for (Penumpang p : penumpangPrioritas) if (p.getID() == id) return true;
        for (Penumpang p : penumpangBiasa) if (p.getID() == id) return true;
        for (Penumpang p : penumpangBerdiri) if (p.getID() == id) return true;
        return false;
    }

    public boolean naikkanPenumpang(Penumpang p) {
        if (p.getSaldo() < ONGKOS_BUS) {
            return false; // saldo kurang
        }
        if (totalPenumpang() >= 40) {
            return false; // bus penuh
        }

        if (p.isPrioritas()) {
            if (penumpangPrioritas.size() < 4) penumpangPrioritas.add(p);
            else if (penumpangBiasa.size() < 16) penumpangBiasa.add(p);
            else penumpangBerdiri.add(p);
        } else {
            if (penumpangBiasa.size() < 16) penumpangBiasa.add(p);
            else penumpangBerdiri.add(p);
        }

        p.kurangiSaldo(ONGKOS_BUS);
        totalPendapatan += ONGKOS_BUS;
        return true;
    }

    public boolean turunkanPenumpang(int id) {
        for (Penumpang p : new ArrayList<Penumpang>(penumpangPrioritas)) {
            if (p.getID() == id) {
                penumpangPrioritas.remove(p);
                return true;
            }
        }
        for (Penumpang p : new ArrayList<Penumpang>(penumpangBiasa)) {
            if (p.getID() == id) {
                penumpangBiasa.remove(p);
                return true;
            }
        }
        for (Penumpang p : new ArrayList<Penumpang>(penumpangBerdiri)) {
            if (p.getID() == id) {
                penumpangBerdiri.remove(p);
                return true;
            }
        }
        return false;
    }

    public int getJumlahPenumpangBiasa() { return penumpangBiasa.size(); }
    public int getJumlahPenumpangPrioritas() { return penumpangPrioritas.size(); }
    public int getJumlahPenumpangBerdiri() { return penumpangBerdiri.size(); }
    public int totalPenumpang() {
        return getJumlahPenumpangBiasa() + getJumlahPenumpangPrioritas() + getJumlahPenumpangBerdiri();
    }

    public int getTotalPendapatan() { return totalPendapatan; }

    public ArrayList<Penumpang> getPenumpangBiasa() { return penumpangBiasa; }
    public ArrayList<Penumpang> getPenumpangPrioritas() { return penumpangPrioritas; }
    public ArrayList<Penumpang> getPenumpangBerdiri() { return penumpangBerdiri; }
}
